
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="GEDI L2A/L2B data extraction and processing tools">
      
      
        <meta name="author" content="Marco Wolsza">
      
      
        <link rel="canonical" href="https://maawoo.github.io/gedixr/api/">
      
      
        <link rel="prev" href="../quality/">
      
      
        <link rel="next" href="../license/">
      
      
        
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>API Reference - gedixr</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="orange">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#python-api" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="gedixr" class="md-header__button md-logo" aria-label="gedixr" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            gedixr
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              API Reference
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="orange"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="orange"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/maawoo/gedixr" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    maawoo/gedixr
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../installation/" class="md-tabs__link">
          
  
  
  Getting Started

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../download/" class="md-tabs__link">
          
  
  
  User Guide

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    <li class="md-tabs__item md-tabs__item--active">
      <a href="./" class="md-tabs__link">
        
  
  
    
  
  API Reference

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../license/" class="md-tabs__link">
          
  
  
  About

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="gedixr" class="md-nav__button md-logo" aria-label="gedixr" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    gedixr
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/maawoo/gedixr" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    maawoo/gedixr
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Getting Started
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Getting Started
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Installation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../quickstart/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Quick Start
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    User Guide
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    User Guide
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../download/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Downloading Data
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../variables/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Default Variables
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../quality/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Quality Filtering
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    API Reference
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    API Reference
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#core-functions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Core Functions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Core Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#download_data" class="md-nav__link">
    <span class="md-ellipsis">
      
        download_data
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gedixr.download.download_data" class="md-nav__link">
    <span class="md-ellipsis">
      
        download_data
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="download_data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#extract_data" class="md-nav__link">
    <span class="md-ellipsis">
      
        extract_data
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gedixr.extract.extract_data" class="md-nav__link">
    <span class="md-ellipsis">
      
        extract_data
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#post-extraction-functions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Post-extraction Functions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Post-extraction Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#load_to_gdf" class="md-nav__link">
    <span class="md-ellipsis">
      
        load_to_gdf
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gedixr.xr.load_to_gdf" class="md-nav__link">
    <span class="md-ellipsis">
      
        load_to_gdf
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="load_to_gdf">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#merge_gdf" class="md-nav__link">
    <span class="md-ellipsis">
      
        merge_gdf
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gedixr.xr.merge_gdf" class="md-nav__link">
    <span class="md-ellipsis">
      
        merge_gdf
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="merge_gdf">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gdf_to_xr" class="md-nav__link">
    <span class="md-ellipsis">
      
        gdf_to_xr
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gedixr.xr.gdf_to_xr" class="md-nav__link">
    <span class="md-ellipsis">
      
        gdf_to_xr
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    About
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    About
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../license/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    License
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#core-functions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Core Functions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Core Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#download_data" class="md-nav__link">
    <span class="md-ellipsis">
      
        download_data
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gedixr.download.download_data" class="md-nav__link">
    <span class="md-ellipsis">
      
        download_data
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="download_data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#extract_data" class="md-nav__link">
    <span class="md-ellipsis">
      
        extract_data
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gedixr.extract.extract_data" class="md-nav__link">
    <span class="md-ellipsis">
      
        extract_data
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#post-extraction-functions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Post-extraction Functions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Post-extraction Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#load_to_gdf" class="md-nav__link">
    <span class="md-ellipsis">
      
        load_to_gdf
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gedixr.xr.load_to_gdf" class="md-nav__link">
    <span class="md-ellipsis">
      
        load_to_gdf
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="load_to_gdf">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#merge_gdf" class="md-nav__link">
    <span class="md-ellipsis">
      
        merge_gdf
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gedixr.xr.merge_gdf" class="md-nav__link">
    <span class="md-ellipsis">
      
        merge_gdf
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="merge_gdf">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gdf_to_xr" class="md-nav__link">
    <span class="md-ellipsis">
      
        gdf_to_xr
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gedixr.xr.gdf_to_xr" class="md-nav__link">
    <span class="md-ellipsis">
      
        gdf_to_xr
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="python-api">Python API<a class="headerlink" href="#python-api" title="Permanent link">&para;</a></h1>
<p>The Python API provides programmatic access to gedixr's functionality for custom 
workflows.</p>
<h2 id="core-functions">Core Functions<a class="headerlink" href="#core-functions" title="Permanent link">&para;</a></h2>
<h3 id="download_data">download_data<a class="headerlink" href="#download_data" title="Permanent link">&para;</a></h3>


<div class="doc doc-object doc-function">



<a id="gedixr.download.download_data"></a>
    <div class="doc doc-contents first">

        <p>Download GEDI data using NASA Harmony API based on a time range and spatial subset.
Please note that if <code>subset_vector</code> is provided, the download will be subset to the
bounding box of the vector geometry and not the exact geometry itself. To perform
precise spatial subsetting, use the vector file again during data extraction.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>directory</code>
            </td>
            <td>
                  <code><span title="str">str</span> or <span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Directory where downloaded files will be saved. A subdirectory named after the
GEDI product will be created within this directory and files will be saved there.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>gedi_product</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>GEDI product name: 'L2A' or 'L2B'</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>time_range</code>
            </td>
            <td>
                  <code>tuple of str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Time range as (start_date, end_date) in format 'YYYY-MM-DD'</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>subset_vector</code>
            </td>
            <td>
                  <code><span title="str">str</span> or <span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to vector file for spatial subsetting. Please note that the download will 
be subset to the bounding box of the vector geometry and not the exact geometry 
itself. To perform precise spatial subsetting, use the vector file again during 
data extraction. If provided, takes precedence over subset_bbox.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>subset_bbox</code>
            </td>
            <td>
                  <code>tuple of float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Bounding box as (min_lon, min_lat, max_lon, max_lat).</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>job_id</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Harmony job ID to resume a previous download. If provided, a new request
will not be submitted and other parameters (time_range, subset_*) are ignored.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>verbose</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to print progress messages</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>tuple of (list of Path, str)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Downloaded file paths and the job ID for potential resumption.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Initial download</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">files</span><span class="p">,</span> <span class="n">job_id</span> <span class="o">=</span> <span class="n">download_data</span><span class="p">(</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="gp">... </span>    <span class="n">directory</span><span class="o">=</span><span class="s1">&#39;data/gedi&#39;</span><span class="p">,</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="gp">... </span>    <span class="n">gedi_product</span><span class="o">=</span><span class="s1">&#39;L2A&#39;</span><span class="p">,</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="gp">... </span>    <span class="n">time_range</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;2020-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2020-01-31&#39;</span><span class="p">),</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="gp">... </span>    <span class="n">subset_bbox</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="gp">... </span><span class="p">)</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Resume interrupted download</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="gp">&gt;&gt;&gt; </span><span class="n">files</span><span class="p">,</span> <span class="n">job_id</span> <span class="o">=</span> <span class="n">download_data</span><span class="p">(</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="gp">... </span>    <span class="n">directory</span><span class="o">=</span><span class="s1">&#39;data/gedi&#39;</span><span class="p">,</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="gp">... </span>    <span class="n">gedi_product</span><span class="o">=</span><span class="s1">&#39;L2A&#39;</span><span class="p">,</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="gp">... </span>    <span class="n">job_id</span><span class="o">=</span><span class="n">job_id</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="gp">... </span><span class="p">)</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>gedixr/download.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-19"> 19</a></span>
<span class="normal"><a href="#__codelineno-0-20"> 20</a></span>
<span class="normal"><a href="#__codelineno-0-21"> 21</a></span>
<span class="normal"><a href="#__codelineno-0-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-0-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-0-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-0-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-0-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-0-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-0-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-0-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-0-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-0-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-0-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-0-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-0-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-0-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-0-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-0-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-0-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-0-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-0-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-0-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-0-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-0-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-0-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-0-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-0-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-0-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-0-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-0-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-0-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-0-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-0-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-0-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-0-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-0-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-0-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-0-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-0-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-0-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-0-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="k">def</span><span class="w"> </span><span class="nf">download_data</span><span class="p">(</span><span class="n">directory</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span><span class="p">,</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>                  <span class="n">gedi_product</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>                  <span class="n">time_range</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>                  <span class="n">subset_vector</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>                  <span class="n">subset_bbox</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a>                  <span class="n">job_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a>                  <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a>                  <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Path</span><span class="p">]:</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="sd">    Download GEDI data using NASA Harmony API based on a time range and spatial subset.</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">    Please note that if `subset_vector` is provided, the download will be subset to the</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">    bounding box of the vector geometry and not the exact geometry itself. To perform</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="sd">    precise spatial subsetting, use the vector file again during data extraction.</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="sd">    directory : str or Path</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="sd">        Directory where downloaded files will be saved. A subdirectory named after the</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="sd">        GEDI product will be created within this directory and files will be saved there.</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="sd">    gedi_product : str</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="sd">        GEDI product name: &#39;L2A&#39; or &#39;L2B&#39;</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="sd">    time_range : tuple of str, optional</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="sd">        Time range as (start_date, end_date) in format &#39;YYYY-MM-DD&#39;</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="sd">    subset_vector : str or Path, optional</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="sd">        Path to vector file for spatial subsetting. Please note that the download will </span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="sd">        be subset to the bounding box of the vector geometry and not the exact geometry </span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="sd">        itself. To perform precise spatial subsetting, use the vector file again during </span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="sd">        data extraction. If provided, takes precedence over subset_bbox.</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="sd">    subset_bbox : tuple of float, optional</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a><span class="sd">        Bounding box as (min_lon, min_lat, max_lon, max_lat).</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="sd">    job_id : str, optional</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="sd">        Harmony job ID to resume a previous download. If provided, a new request</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="sd">        will not be submitted and other parameters (time_range, subset_*) are ignored.</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="sd">    verbose : bool, default=True</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="sd">        Whether to print progress messages</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="sd">    -------</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a><span class="sd">    tuple of (list of Path, str)</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a><span class="sd">        Downloaded file paths and the job ID for potential resumption.</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a><span class="sd">    Examples</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="sd">    --------</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="sd">    &gt;&gt;&gt; # Initial download</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a><span class="sd">    &gt;&gt;&gt; files, job_id = download_data(</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a><span class="sd">    ...     directory=&#39;data/gedi&#39;,</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a><span class="sd">    ...     gedi_product=&#39;L2A&#39;,</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a><span class="sd">    ...     time_range=(&#39;2020-01-01&#39;, &#39;2020-01-31&#39;),</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="sd">    ...     subset_bbox=(-10, 40, 5, 50)</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a><span class="sd">    ... )</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="sd">    &gt;&gt;&gt; # Resume interrupted download</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="sd">    &gt;&gt;&gt; files, job_id = download_data(</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="sd">    ...     directory=&#39;data/gedi&#39;,</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="sd">    ...     gedi_product=&#39;L2A&#39;,</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="sd">    ...     job_id=job_id</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="sd">    ... )</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>    <span class="n">short_name</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">PRODUCT_MAPPING</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">gedi_product</span><span class="o">.</span><span class="n">upper</span><span class="p">())</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>    <span class="k">if</span> <span class="n">short_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Parameter &#39;gedi_product&#39;: expected to be one of &quot;</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>                        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">list</span><span class="p">(</span><span class="n">con</span><span class="o">.</span><span class="n">PRODUCT_MAPPING</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="si">}</span><span class="s2">; got &#39;</span><span class="si">{</span><span class="n">gedi_product</span><span class="si">}</span><span class="s2">&#39; instead&quot;</span><span class="p">)</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>    <span class="n">directory</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">directory</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Directory does not exist: </span><span class="si">{</span><span class="n">directory</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>    <span class="n">download_dir</span> <span class="o">=</span> <span class="n">directory</span><span class="o">.</span><span class="n">joinpath</span><span class="p">(</span><span class="n">gedi_product</span><span class="o">.</span><span class="n">upper</span><span class="p">())</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>    <span class="n">download_dir</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>    <span class="n">harmony_client</span> <span class="o">=</span> <span class="n">_authenticate_earthdata</span><span class="p">()</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>    <span class="n">job_id_file</span> <span class="o">=</span> <span class="n">download_dir</span><span class="o">.</span><span class="n">joinpath</span><span class="p">(</span><span class="s1">&#39;.harmony_job_id&#39;</span><span class="p">)</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>    <span class="k">if</span> <span class="n">job_id</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>        <span class="k">if</span> <span class="n">job_id_file</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>            <span class="n">saved_job_id</span> <span class="o">=</span> <span class="n">job_id_file</span><span class="o">.</span><span class="n">read_text</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Found existing job ID from previous run: </span><span class="si">{</span><span class="n">saved_job_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;To resume this job, pass job_id parameter.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Submitting new request...&quot;</span><span class="p">)</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>        <span class="k">if</span> <span class="n">time_range</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>            <span class="n">time_range</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;start&#39;</span><span class="p">:</span> <span class="n">dt</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">fromisoformat</span><span class="p">(</span><span class="n">time_range</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>                          <span class="s1">&#39;stop&#39;</span><span class="p">:</span> <span class="n">dt</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">fromisoformat</span><span class="p">(</span><span class="n">time_range</span><span class="p">[</span><span class="mi">1</span><span class="p">])}</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>        <span class="n">bbox</span> <span class="o">=</span> <span class="n">_get_bbox</span><span class="p">(</span><span class="n">subset_vector</span><span class="p">,</span> <span class="n">subset_bbox</span><span class="p">)</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>        <span class="n">capabilities</span> <span class="o">=</span> <span class="n">harmony_client</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span><span class="n">CapabilitiesRequest</span><span class="p">(</span><span class="n">short_name</span><span class="o">=</span><span class="n">short_name</span><span class="p">))</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>        <span class="n">collection</span> <span class="o">=</span> <span class="n">Collection</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">capabilities</span><span class="p">[</span><span class="s1">&#39;conceptId&#39;</span><span class="p">])</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>        <span class="n">request</span> <span class="o">=</span> <span class="n">Request</span><span class="p">(</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>            <span class="n">collection</span><span class="o">=</span><span class="n">collection</span><span class="p">,</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>            <span class="n">spatial</span><span class="o">=</span><span class="n">bbox</span><span class="p">,</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>            <span class="n">temporal</span><span class="o">=</span><span class="n">time_range</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>        <span class="p">)</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">request</span><span class="o">.</span><span class="n">is_valid</span><span class="p">():</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid Harmony request: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>        <span class="n">job_id</span> <span class="o">=</span> <span class="n">harmony_client</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>        
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>        <span class="n">job_id_file</span><span class="o">.</span><span class="n">write_text</span><span class="p">(</span><span class="n">job_id</span><span class="p">)</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Job submitted with ID: </span><span class="si">{</span><span class="n">job_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Job ID saved to: </span><span class="si">{</span><span class="n">job_id_file</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Resuming job with ID: </span><span class="si">{</span><span class="n">job_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>        <span class="n">job_id_file</span><span class="o">.</span><span class="n">write_text</span><span class="p">(</span><span class="n">job_id</span><span class="p">)</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Files will be processed by Harmony before proceeding with download...&quot;</span><span class="p">)</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>        <span class="n">result_json</span> <span class="o">=</span> <span class="n">harmony_client</span><span class="o">.</span><span class="n">result_json</span><span class="p">(</span><span class="n">job_id</span><span class="p">,</span> <span class="n">show_progress</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>        <span class="n">status</span> <span class="o">=</span> <span class="n">result_json</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;status&#39;</span><span class="p">,</span> <span class="s1">&#39;unknown&#39;</span><span class="p">)</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>        <span class="k">if</span> <span class="n">status</span> <span class="o">==</span> <span class="s1">&#39;failed&#39;</span><span class="p">:</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>            <span class="n">_failed_status</span><span class="p">(</span><span class="n">download_dir</span><span class="p">,</span> <span class="n">job_id</span><span class="p">,</span> <span class="n">job_id_file</span><span class="p">,</span> <span class="n">result_json</span><span class="p">)</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>        <span class="k">elif</span> <span class="n">status</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;successful&#39;</span><span class="p">,</span> <span class="s1">&#39;complete&#39;</span><span class="p">]:</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>                <span class="sa">f</span><span class="s2">&quot;Harmony job status is &#39;</span><span class="si">{</span><span class="n">status</span><span class="si">}</span><span class="s2">&#39;. Proceeding with download but results may be incomplete.&quot;</span><span class="p">,</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>                <span class="ne">UserWarning</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>            <span class="p">)</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Processing complete. Starting download...&quot;</span><span class="p">)</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>        <span class="n">results</span> <span class="o">=</span> <span class="n">harmony_client</span><span class="o">.</span><span class="n">download_all</span><span class="p">(</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>            <span class="n">job_id</span><span class="p">,</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>            <span class="n">directory</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">download_dir</span><span class="p">),</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>            <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>        <span class="p">)</span>    
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>        <span class="n">file_paths</span> <span class="o">=</span> <span class="p">[</span><span class="n">Path</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">result</span><span class="p">())</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">results</span><span class="p">]</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Downloaded </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">file_paths</span><span class="p">)</span><span class="si">}</span><span class="s2"> file(s) to </span><span class="si">{</span><span class="n">download_dir</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">file_paths</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>                <span class="s2">&quot;No files were downloaded. This may indicate an issue with the request or data availability.&quot;</span><span class="p">,</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>                <span class="ne">UserWarning</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>            <span class="p">)</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>        <span class="k">if</span> <span class="n">job_id_file</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>            <span class="n">job_id_file</span><span class="o">.</span><span class="n">unlink</span><span class="p">()</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>        <span class="k">return</span> <span class="n">file_paths</span><span class="p">,</span> <span class="n">job_id</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>    <span class="k">except</span> <span class="p">(</span><span class="ne">KeyboardInterrupt</span><span class="p">,</span> <span class="ne">Exception</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="ne">KeyboardInterrupt</span><span class="p">):</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Download interrupted by user. Job ID saved to: </span><span class="si">{</span><span class="n">job_id_file</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Download interrupted due to error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Job ID saved to: </span><span class="si">{</span><span class="n">job_id_file</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;To resume, run:&quot;</span><span class="p">)</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  download_data(directory=&#39;</span><span class="si">{</span><span class="n">directory</span><span class="si">}</span><span class="s2">&#39;, gedi_product=&#39;</span><span class="si">{</span><span class="n">gedi_product</span><span class="si">}</span><span class="s2">&#39;, job_id=&#39;</span><span class="si">{</span><span class="n">job_id</span><span class="si">}</span><span class="s2">&#39;)&quot;</span><span class="p">)</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;or use the CLI with --job-id option.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>        <span class="k">raise</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div><h3 id="extract_data">extract_data<a class="headerlink" href="#extract_data" title="Permanent link">&para;</a></h3>


<div class="doc doc-object doc-function">



<a id="gedixr.extract.extract_data"></a>
    <div class="doc doc-contents first">

        <p>Extracts data from GEDI L2A or L2B files in HDF5 format using the following
steps:</p>
<p>(1) Search a root directory recursively for GEDI L2A or L2B HDF5 files
(2) OPTIONAL: Filter files by month of acquisition
(3) Extract data from each file for specified beams and variables into a Dataframe
(4) OPTIONAL: Filter out shots of poor quality
(5) Convert Dataframe to GeoDataFrame including geometry column
(6) OPTIONAL: Subset shots spatially using intersection via provided vector
    file or list of vector files
(7) Save the result as a GeoParquet file or multiple files (one per
    provided vector file, if applicable)
(8) Return a GeoDataFrame or dictionary of GeoDataFrame objects (one per provided
    vector file, if applicable)</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>directory</code>
            </td>
            <td>
                  <code><span title="str">str</span> | <span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Root directory to recursively search for GEDI L2A/L2B files.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>gedi_product</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>GEDI product type. Either 'L2A' or 'L2B'. Default is 'L2B'.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>variables</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="list">list</span>[<span title="tuple">tuple</span>[<span title="str">str</span>, <span title="str">str</span>]]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of tuples containing the desired column name in the returned
GeoDataFrame and the GEDI layer name to be extracted. Defaults to those
retrieved by <code>gedixr.constants.DEFAULT_VARIABLES['&lt;gedi_product&gt;']</code>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>beams</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span> | <span title="list">list</span>[<span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Which GEDI beams to extract values from? Defaults to all beams (power and
coverage beams). Use <code>'power'</code> or <code>'coverage'</code> for power or coverage beams,
respectively. You can also provide a list of beam names, e.g.:
<code>['BEAM0101', 'BEAM0110']</code>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>filter_month</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="tuple">tuple</span>[<span title="int">int</span>, <span title="int">int</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Filter GEDI shots by month of the year? E.g. (6, 8) to only keep shots
that were acquired between June 1st and August 31st of each year.
Defaults to (1, 12), which keeps all shots of each year.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>subset_vector</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span> | <span title="pathlib.Path">Path</span> | <span title="list">list</span>[<span title="str">str</span> | <span title="pathlib.Path">Path</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path or list of paths to vector files in a fiona supported format to
subset the GEDI data spatially. Default is None, to keep all shots.
Note that the basename of each vector file will be used in the output
names, so it is recommended to give those files reasonable names
beforehand!</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>apply_quality_filter</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Apply a basic quality filter to the GEDI data? Default is True. This basic
filtering strategy will filter out shots with quality_flag != 1,
degrade_flag != 0, num_detectedmodes &gt; 1, and difference between detected
elevation and DEM elevation &lt; 100 m.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td></td>            <td>
                  <code><span title="geopandas.GeoDataFrame">GeoDataFrame</span> or <span title="dictionary">dictionary</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>In case of an output dictionary, these are the expected key, value pairs:
    <code>{'&lt;Vector Basename&gt;': {'geo': Polygon, 'gdf': GeoDataFrame, 'path': Path}}</code>
    where 'geo' is the geometry of the vector file, 'gdf' is the extracted
    GeoDataFrame for that geometry, and 'path' is the path to the output
    GeoParquet file.
If no vector files were provided, a single GeoDataFrame is returned.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>out_path</code></td>            <td>
                  <code><span title="pathlib.Path">Path</span> or None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>In case no vector files were provided, the path to the output GeoParquet
file is returned. Otherwise, None is returned as the output paths are
included in the output dictionary.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>gedixr/extract.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-20"> 20</a></span>
<span class="normal"><a href="#__codelineno-0-21"> 21</a></span>
<span class="normal"><a href="#__codelineno-0-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-0-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-0-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-0-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-0-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-0-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-0-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-0-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-0-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-0-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-0-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-0-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-0-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-0-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-0-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-0-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-0-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-0-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-0-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-0-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-0-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-0-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-0-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-0-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-0-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-0-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-0-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-0-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-0-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-0-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-0-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-0-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-0-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-0-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-0-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-0-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-0-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-0-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-0-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="k">def</span><span class="w"> </span><span class="nf">extract_data</span><span class="p">(</span><span class="n">directory</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span><span class="p">,</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>                 <span class="n">gedi_product</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>                 <span class="n">variables</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>                 <span class="n">beams</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a>                 <span class="n">filter_month</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a>                 <span class="n">subset_vector</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a>                 <span class="n">apply_quality_filter</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a>                 <span class="p">)</span> <span class="o">-&gt;</span> <span class="p">(</span><span class="n">GeoDataFrame</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">GeoDataFrame</span> <span class="o">|</span> <span class="n">Polygon</span><span class="p">]</span> <span class="o">|</span> <span class="n">Path</span><span class="p">],</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Path</span><span class="p">]):</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">    Extracts data from GEDI L2A or L2B files in HDF5 format using the following</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">    steps:</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="sd">    (1) Search a root directory recursively for GEDI L2A or L2B HDF5 files</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">    (2) OPTIONAL: Filter files by month of acquisition</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="sd">    (3) Extract data from each file for specified beams and variables into a Dataframe</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="sd">    (4) OPTIONAL: Filter out shots of poor quality</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="sd">    (5) Convert Dataframe to GeoDataFrame including geometry column</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="sd">    (6) OPTIONAL: Subset shots spatially using intersection via provided vector</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="sd">        file or list of vector files</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="sd">    (7) Save the result as a GeoParquet file or multiple files (one per</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="sd">        provided vector file, if applicable)</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="sd">    (8) Return a GeoDataFrame or dictionary of GeoDataFrame objects (one per provided</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="sd">        vector file, if applicable)</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="sd">    directory: str or Path</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="sd">        Root directory to recursively search for GEDI L2A/L2B files.</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a><span class="sd">    gedi_product: str</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="sd">        GEDI product type. Either &#39;L2A&#39; or &#39;L2B&#39;. Default is &#39;L2B&#39;.</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="sd">    variables: list of tuple of str, optional</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a><span class="sd">        List of tuples containing the desired column name in the returned</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="sd">        GeoDataFrame and the GEDI layer name to be extracted. Defaults to those</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="sd">        retrieved by `gedixr.constants.DEFAULT_VARIABLES[&#39;&lt;gedi_product&gt;&#39;]`.</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a><span class="sd">    beams: str or list of str, optional</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a><span class="sd">        Which GEDI beams to extract values from? Defaults to all beams (power and</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="sd">        coverage beams). Use `&#39;power&#39;` or `&#39;coverage&#39;` for power or coverage beams,</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a><span class="sd">        respectively. You can also provide a list of beam names, e.g.:</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a><span class="sd">        `[&#39;BEAM0101&#39;, &#39;BEAM0110&#39;]`.</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a><span class="sd">    filter_month: tuple(int), optional</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a><span class="sd">        Filter GEDI shots by month of the year? E.g. (6, 8) to only keep shots</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="sd">        that were acquired between June 1st and August 31st of each year.</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="sd">        Defaults to (1, 12), which keeps all shots of each year.</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a><span class="sd">    subset_vector: str or Path or list of str or Path, optional</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a><span class="sd">        Path or list of paths to vector files in a fiona supported format to</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a><span class="sd">        subset the GEDI data spatially. Default is None, to keep all shots.</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a><span class="sd">        Note that the basename of each vector file will be used in the output</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="sd">        names, so it is recommended to give those files reasonable names</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a><span class="sd">        beforehand!</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="sd">    apply_quality_filter: bool, optional</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="sd">        Apply a basic quality filter to the GEDI data? Default is True. This basic</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="sd">        filtering strategy will filter out shots with quality_flag != 1,</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="sd">        degrade_flag != 0, num_detectedmodes &gt; 1, and difference between detected</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="sd">        elevation and DEM elevation &lt; 100 m.</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="sd">    -------</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="sd">    GeoDataFrame or dictionary</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="sd">        In case of an output dictionary, these are the expected key, value pairs:</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="sd">            `{&#39;&lt;Vector Basename&gt;&#39;: {&#39;geo&#39;: Polygon, &#39;gdf&#39;: GeoDataFrame, &#39;path&#39;: Path}}`</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="sd">            where &#39;geo&#39; is the geometry of the vector file, &#39;gdf&#39; is the extracted</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="sd">            GeoDataFrame for that geometry, and &#39;path&#39; is the path to the output</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="sd">            GeoParquet file.</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="sd">        If no vector files were provided, a single GeoDataFrame is returned.</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="sd">    out_path: Path or None</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="sd">        In case no vector files were provided, the path to the output GeoParquet</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a><span class="sd">        file is returned. Otherwise, None is returned as the output paths are</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="sd">        included in the output dictionary.</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>    <span class="k">if</span> <span class="n">gedi_product</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">con</span><span class="o">.</span><span class="n">ALLOWED_PRODUCTS</span><span class="p">:</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Parameter &#39;gedi_product&#39;: expected to be one of &quot;</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>                           <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">con</span><span class="o">.</span><span class="n">ALLOWED_PRODUCTS</span><span class="si">}</span><span class="s2">; got </span><span class="si">{</span><span class="n">gedi_product</span><span class="si">}</span><span class="s2"> instead&quot;</span><span class="p">)</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>    <span class="n">directory</span> <span class="o">=</span> <span class="n">anc</span><span class="o">.</span><span class="n">to_pathlib</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">directory</span><span class="p">)</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>    <span class="n">subset_vector</span> <span class="o">=</span> <span class="n">anc</span><span class="o">.</span><span class="n">to_pathlib</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">subset_vector</span><span class="p">)</span> <span class="k">if</span> \
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>        <span class="p">(</span><span class="n">subset_vector</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="k">else</span> <span class="kc">None</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>    <span class="n">log_handler</span><span class="p">,</span> <span class="n">now</span> <span class="o">=</span> <span class="n">anc</span><span class="o">.</span><span class="n">set_logging</span><span class="p">(</span><span class="n">directory</span><span class="p">,</span> <span class="n">gedi_product</span><span class="p">)</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>    <span class="n">anc</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">handler</span><span class="o">=</span><span class="n">log_handler</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;info&#39;</span><span class="p">,</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>            <span class="n">msg</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Starting GEDI </span><span class="si">{</span><span class="n">gedi_product</span><span class="si">}</span><span class="s2"> data extraction using parameters: &quot;</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>                <span class="sa">f</span><span class="s2">&quot;variables=</span><span class="si">{</span><span class="n">variables</span><span class="si">}</span><span class="s2">, beams=</span><span class="si">{</span><span class="n">beams</span><span class="si">}</span><span class="s2">, &quot;</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>                <span class="sa">f</span><span class="s2">&quot;filter_month=</span><span class="si">{</span><span class="n">filter_month</span><span class="si">}</span><span class="s2">, &quot;</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>                <span class="sa">f</span><span class="s2">&quot;subset_vector=</span><span class="si">{</span><span class="n">subset_vector</span><span class="si">}</span><span class="s2">, &quot;</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>                <span class="sa">f</span><span class="s2">&quot;apply_quality_filter=</span><span class="si">{</span><span class="n">apply_quality_filter</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>    <span class="n">anc</span><span class="o">.</span><span class="n">error_tracker</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span> 
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>    <span class="n">out_dict</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>    <span class="k">if</span> <span class="n">gedi_product</span> <span class="o">==</span> <span class="s1">&#39;L2A&#39;</span><span class="p">:</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>        <span class="n">variables</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">DEFAULT_VARIABLES</span><span class="p">[</span><span class="s1">&#39;L2A&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="n">variables</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">variables</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>        <span class="n">pattern</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">PATTERN_L2A</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>        <span class="n">variables</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">DEFAULT_VARIABLES</span><span class="p">[</span><span class="s1">&#39;L2B&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="n">variables</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">variables</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>        <span class="n">pattern</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">PATTERN_L2B</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>    <span class="k">if</span> <span class="n">beams</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>        <span class="n">beams</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">POWER_BEAMS</span> <span class="o">+</span> <span class="n">con</span><span class="o">.</span><span class="n">COVERAGE_BEAMS</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>    <span class="k">elif</span> <span class="n">beams</span> <span class="o">==</span> <span class="s1">&#39;power&#39;</span><span class="p">:</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>        <span class="n">beams</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">POWER_BEAMS</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>    <span class="k">elif</span> <span class="n">beams</span> <span class="o">==</span> <span class="s1">&#39;coverage&#39;</span><span class="p">:</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>        <span class="n">beams</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">COVERAGE_BEAMS</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>        <span class="n">beams</span> <span class="o">=</span> <span class="n">beams</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>    <span class="k">if</span> <span class="n">filter_month</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>        <span class="n">filter_month</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>    <span class="k">if</span> <span class="n">subset_vector</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>        <span class="n">out_dict</span> <span class="o">=</span> <span class="n">anc</span><span class="o">.</span><span class="n">prepare_vec</span><span class="p">(</span><span class="n">vec</span><span class="o">=</span><span class="n">subset_vector</span><span class="p">)</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>    <span class="n">layers</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">DEFAULT_BASE</span><span class="p">[</span><span class="n">gedi_product</span><span class="p">]</span> <span class="o">+</span> <span class="n">variables</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>        <span class="c1"># (1) Search for GEDI files</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>        <span class="n">filepaths</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">directory</span><span class="o">.</span><span class="n">rglob</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">p</span><span class="o">.</span><span class="n">is_file</span><span class="p">()</span> <span class="ow">and</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>                     <span class="n">p</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">pattern</span><span class="p">)]</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">filepaths</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No GEDI </span><span class="si">{</span><span class="n">gedi_product</span><span class="si">}</span><span class="s2"> files were found in &quot;</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>                               <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">directory</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>        <span class="n">gdf_list_no_spatial_subset</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">fp</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tqdm</span><span class="p">(</span><span class="n">filepaths</span><span class="p">)):</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>            <span class="c1"># (2) Filter by month of acquisition</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>            <span class="n">date</span> <span class="o">=</span> <span class="n">_date_from_gedi_file</span><span class="p">(</span><span class="n">gedi_path</span><span class="o">=</span><span class="n">fp</span><span class="p">)</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>            <span class="k">if</span> <span class="n">filter_month</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">filter_month</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>                <span class="n">filter_month</span> <span class="o">=</span> <span class="p">(</span><span class="n">filter_month</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">filter_month</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">filter_month</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">date</span><span class="o">.</span><span class="n">month</span> <span class="o">&lt;=</span> <span class="n">filter_month</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>                <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Time of acquisition outside of filter range: &quot;</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>                       <span class="sa">f</span><span class="s2">&quot;month_min=</span><span class="si">{</span><span class="n">filter_month</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, &quot;</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>                       <span class="sa">f</span><span class="s2">&quot;month_max=</span><span class="si">{</span><span class="n">filter_month</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>                <span class="n">anc</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">handler</span><span class="o">=</span><span class="n">log_handler</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;info&#39;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">fp</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="n">msg</span><span class="p">)</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>                <span class="k">continue</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>            <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>                <span class="n">gedi</span> <span class="o">=</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>                <span class="c1"># (3) Extract data for specified beams and variables</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>                <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">_from_file</span><span class="p">(</span><span class="n">gedi</span><span class="o">=</span><span class="n">gedi</span><span class="p">,</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>                                             <span class="n">gedi_fp</span><span class="o">=</span><span class="n">fp</span><span class="p">,</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>                                             <span class="n">gedi_product</span><span class="o">=</span><span class="n">gedi_product</span><span class="p">,</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>                                             <span class="n">beams</span><span class="o">=</span><span class="n">beams</span><span class="p">,</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>                                             <span class="n">layers</span><span class="o">=</span><span class="n">layers</span><span class="p">,</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>                                             <span class="n">acq_time</span><span class="o">=</span><span class="n">date</span><span class="p">,</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>                                             <span class="n">log_handler</span><span class="o">=</span><span class="n">log_handler</span><span class="p">))</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>                <span class="c1"># (4) Filter by quality flags</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a>                <span class="k">if</span> <span class="n">apply_quality_filter</span><span class="p">:</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>                    <span class="n">df</span> <span class="o">=</span> <span class="n">_filter_quality</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">log_handler</span><span class="o">=</span><span class="n">log_handler</span><span class="p">,</span> <span class="n">gedi_path</span><span class="o">=</span><span class="n">fp</span><span class="p">)</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>                <span class="c1"># (5) Convert to GeoDataFrame, set &#39;Shot Number&#39; as index and convert</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a>                <span class="c1"># acquisition time to datetime</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>                <span class="n">df</span><span class="p">[</span><span class="s1">&#39;geometry&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">row</span><span class="p">:</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a>                                          <span class="n">Point</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">longitude</span><span class="p">,</span> <span class="n">row</span><span class="o">.</span><span class="n">latitude</span><span class="p">),</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>                                          <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>                <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="s1">&#39;longitude&#39;</span><span class="p">])</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>                <span class="n">gdf</span> <span class="o">=</span> <span class="n">gp</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>                <span class="n">gdf</span><span class="o">.</span><span class="n">set_crs</span><span class="p">(</span><span class="n">epsg</span><span class="o">=</span><span class="mi">4326</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>                <span class="n">gdf</span><span class="p">[</span><span class="s1">&#39;acq_time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">gdf</span><span class="p">[</span><span class="s1">&#39;acq_time&#39;</span><span class="p">])</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>                <span class="c1"># (6) Subset spatially if any vector files were provided</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>                <span class="k">if</span> <span class="n">subset_vector</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>                    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">out_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>                        <span class="n">gdf_sub</span> <span class="o">=</span> <span class="n">gdf</span><span class="p">[</span><span class="n">gdf</span><span class="o">.</span><span class="n">intersects</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="s1">&#39;geo&#39;</span><span class="p">])]</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>                        <span class="k">if</span> <span class="ow">not</span> <span class="n">gdf_sub</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>                            <span class="k">if</span> <span class="n">out_dict</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;gdf&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>                                <span class="n">out_dict</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;gdf&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gdf_sub</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>                            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>                                <span class="n">gdf_cat</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">out_dict</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;gdf&#39;</span><span class="p">],</span> <span class="n">gdf_sub</span><span class="p">])</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>                                <span class="n">out_dict</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;gdf&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gdf_cat</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>                        <span class="k">del</span> <span class="n">gdf_sub</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="n">gdf</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>                        <span class="n">gdf_list_no_spatial_subset</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">gdf</span><span class="p">)</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>                <span class="n">gedi</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>                <span class="k">del</span> <span class="n">df</span><span class="p">,</span> <span class="n">gdf</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">msg</span><span class="p">:</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>                <span class="n">anc</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">handler</span><span class="o">=</span><span class="n">log_handler</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;exception&#39;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">fp</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>                        <span class="n">msg</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">msg</span><span class="p">))</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>                <span class="n">anc</span><span class="o">.</span><span class="n">error_tracker</span><span class="o">.</span><span class="n">increment</span><span class="p">()</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>        <span class="c1"># (7) &amp; (8)</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>        <span class="n">flt</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">apply_quality_filter</span> <span class="k">else</span> <span class="mi">0</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>        <span class="n">out_dir</span> <span class="o">=</span> <span class="n">directory</span> <span class="o">/</span> <span class="s1">&#39;extracted&#39;</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>        <span class="n">out_dir</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>        <span class="k">if</span> <span class="n">subset_vector</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">out_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>                <span class="n">v</span><span class="p">[</span><span class="s1">&#39;path&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>                <span class="k">if</span> <span class="n">v</span><span class="p">[</span><span class="s1">&#39;gdf&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>                    <span class="n">out_path</span> <span class="o">=</span> <span class="n">out_dir</span><span class="o">.</span><span class="n">joinpath</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">now</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">gedi_product</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">flt</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s1">.parquet&#39;</span><span class="p">)</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>                    <span class="n">v</span><span class="p">[</span><span class="s1">&#39;gdf&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_parquet</span><span class="p">(</span><span class="n">out_path</span><span class="p">)</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>                    <span class="n">v</span><span class="p">[</span><span class="s1">&#39;path&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">out_path</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>            <span class="k">return</span> <span class="n">out_dict</span><span class="p">,</span> <span class="kc">None</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>            <span class="n">out_path</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>            <span class="c1"># make sure that gdf&#39;s in list are not all empty </span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>            <span class="k">if</span> <span class="n">gdf_list_no_spatial_subset</span><span class="p">:</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>                <span class="n">out</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">gdf_list_no_spatial_subset</span><span class="p">)</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>                <span class="n">out_path</span> <span class="o">=</span> <span class="n">out_dir</span><span class="o">.</span><span class="n">joinpath</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">now</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">gedi_product</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">flt</span><span class="si">}</span><span class="s1">.parquet&#39;</span><span class="p">)</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>                <span class="n">out</span><span class="o">.</span><span class="n">to_parquet</span><span class="p">(</span><span class="n">out_path</span><span class="p">)</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>                <span class="n">anc</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">handler</span><span class="o">=</span><span class="n">log_handler</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;info&#39;</span><span class="p">,</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>                        <span class="n">msg</span><span class="o">=</span><span class="s2">&quot;No GEDI shots passed the filtering criteria; &quot;</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>                            <span class="s2">&quot;no output file created.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>                <span class="n">out</span> <span class="o">=</span> <span class="n">GeoDataFrame</span><span class="p">()</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>            <span class="k">return</span> <span class="n">out</span><span class="p">,</span> <span class="n">out_path</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">msg</span><span class="p">:</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>        <span class="n">anc</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">handler</span><span class="o">=</span><span class="n">log_handler</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;exception&#39;</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">msg</span><span class="p">))</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>        <span class="n">anc</span><span class="o">.</span><span class="n">error_tracker</span><span class="o">.</span><span class="n">increment</span><span class="p">()</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>    <span class="k">finally</span><span class="p">:</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>        <span class="n">anc</span><span class="o">.</span><span class="n">close_logging</span><span class="p">(</span><span class="n">log_handler</span><span class="o">=</span><span class="n">log_handler</span><span class="p">)</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>        <span class="n">error_count</span> <span class="o">=</span> <span class="n">anc</span><span class="o">.</span><span class="n">error_tracker</span><span class="o">.</span><span class="n">count</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>        <span class="k">if</span> <span class="n">error_count</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;WARNING: </span><span class="si">{</span><span class="n">error_count</span><span class="si">}</span><span class="s2"> errors occurred during the extraction &quot;</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>                  <span class="sa">f</span><span class="s2">&quot;process. Please check the log file!&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div><h2 id="post-extraction-functions">Post-extraction Functions<a class="headerlink" href="#post-extraction-functions" title="Permanent link">&para;</a></h2>
<h3 id="load_to_gdf">load_to_gdf<a class="headerlink" href="#load_to_gdf" title="Permanent link">&para;</a></h3>


<div class="doc doc-object doc-function">



<a id="gedixr.xr.load_to_gdf"></a>
    <div class="doc doc-contents first">

        <p>Loads GEDI L2A and/or L2B GeoParquet or GeoPackage files as GeoDataFrames. 
If both are provided, they will be merged into a single GeoDataFrame.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>l2a</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span> | <span title="pathlib.Path">Path</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to a GEDI L2A GeoParquet or GeoPackage file.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>l2b</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span> | <span title="pathlib.Path">Path</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to a GEDI L2B GeoParquet or GeoPackage file.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>final_gdf</code></td>            <td>
                  <code><span title="geopandas.GeoDataFrame">GeoDataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>GeoDataFrame containing the data from the provided GEDI L2A and/or L2B files.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>gedixr/xr.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-11">11</a></span>
<span class="normal"><a href="#__codelineno-0-12">12</a></span>
<span class="normal"><a href="#__codelineno-0-13">13</a></span>
<span class="normal"><a href="#__codelineno-0-14">14</a></span>
<span class="normal"><a href="#__codelineno-0-15">15</a></span>
<span class="normal"><a href="#__codelineno-0-16">16</a></span>
<span class="normal"><a href="#__codelineno-0-17">17</a></span>
<span class="normal"><a href="#__codelineno-0-18">18</a></span>
<span class="normal"><a href="#__codelineno-0-19">19</a></span>
<span class="normal"><a href="#__codelineno-0-20">20</a></span>
<span class="normal"><a href="#__codelineno-0-21">21</a></span>
<span class="normal"><a href="#__codelineno-0-22">22</a></span>
<span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="k">def</span><span class="w"> </span><span class="nf">load_to_gdf</span><span class="p">(</span><span class="n">l2a</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a>                <span class="n">l2b</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="n">Path</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a>                <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">GeoDataFrame</span><span class="p">:</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="sd">    Loads GEDI L2A and/or L2B GeoParquet or GeoPackage files as GeoDataFrames. </span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="sd">    If both are provided, they will be merged into a single GeoDataFrame.</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="sd">    l2a: str or Path, optional</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="sd">        Path to a GEDI L2A GeoParquet or GeoPackage file.</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="sd">    l2b: str or Path, optional</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="sd">        Path to a GEDI L2B GeoParquet or GeoPackage file.</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="sd">    -------</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">    final_gdf: GeoDataFrame</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="sd">        GeoDataFrame containing the data from the provided GEDI L2A and/or L2B files.</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a>    <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">x</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="n">l2a</span><span class="p">,</span> <span class="n">l2b</span><span class="p">]):</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;At least one of the parameters &#39;l2a&#39; or &quot;</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>                           <span class="s2">&quot;&#39;l2b&#39; must be provided!&quot;</span><span class="p">)</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a>    <span class="k">elif</span> <span class="nb">all</span><span class="p">(</span><span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="n">l2a</span><span class="p">,</span> <span class="n">l2b</span><span class="p">]):</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>        <span class="n">gdf_l2a</span> <span class="o">=</span> <span class="n">_reader</span><span class="p">(</span><span class="n">l2a</span><span class="p">)</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>        <span class="n">gdf_l2b</span> <span class="o">=</span> <span class="n">_reader</span><span class="p">(</span><span class="n">l2b</span><span class="p">)</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>        <span class="n">final_gdf</span> <span class="o">=</span> <span class="n">merge_gdf</span><span class="p">(</span><span class="n">l2a</span><span class="o">=</span><span class="n">gdf_l2a</span><span class="p">,</span> <span class="n">l2b</span><span class="o">=</span><span class="n">gdf_l2b</span><span class="p">)</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>        <span class="n">fp</span> <span class="o">=</span> <span class="n">l2a</span> <span class="k">if</span> <span class="n">l2a</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">l2b</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>        <span class="n">final_gdf</span> <span class="o">=</span> <span class="n">_reader</span><span class="p">(</span><span class="n">fp</span><span class="p">)</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>        <span class="n">final_gdf</span><span class="p">[</span><span class="s1">&#39;acq_time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">final_gdf</span><span class="p">[</span><span class="s1">&#39;acq_time&#39;</span><span class="p">])</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>    <span class="k">return</span> <span class="n">final_gdf</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div><h3 id="merge_gdf">merge_gdf<a class="headerlink" href="#merge_gdf" title="Permanent link">&para;</a></h3>


<div class="doc doc-object doc-function">



<a id="gedixr.xr.merge_gdf"></a>
    <div class="doc doc-contents first">

        <p>Merges the data of two GeoDataFrames containing GEDI L2A and L2B data. If
dictionaries are provided, the function assumes key, value pairs of the dictionary
output of <code>gedixr.extract.extract_data</code>. The function will merge the data of
matching geometries and return a dictionary of GeoDataFrames.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>l2a</code>
            </td>
            <td>
                  <code><span title="geopandas.GeoDataFrame">GeoDataFrame</span> | <span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>GeoDataFrame or a dictionary of GeoDataFrames containing GEDI L2A data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>l2b</code>
            </td>
            <td>
                  <code><span title="geopandas.GeoDataFrame">GeoDataFrame</span> | <span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>GeoDataFrame or a dictionary of GeoDataFrames containing GEDI L2B data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>how</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The type of merge to be performed. Default is 'inner'.</p>
              </div>
            </td>
            <td>
                  <code>&#39;inner&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>on</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span> | <span title="list">list</span>[<span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The column(s) to merge on. Default is ['geometry', 'shot', 'acq_time'].</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>merged_out</code></td>            <td>
                  <code><span title="geopandas.GeoDataFrame">GeoDataFrame</span> or <span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A GeoDataFrame or a dictionary of GeoDataFrames containing the merged
GEDI L2A and L2B data.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>gedixr/xr.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-0-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-0-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-0-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-0-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="k">def</span><span class="w"> </span><span class="nf">merge_gdf</span><span class="p">(</span><span class="n">l2a</span><span class="p">:</span> <span class="n">GeoDataFrame</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">,</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>              <span class="n">l2b</span><span class="p">:</span> <span class="n">GeoDataFrame</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">,</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>              <span class="n">how</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;inner&#39;</span><span class="p">,</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>              <span class="n">on</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>              <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">GeoDataFrame</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">:</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="sd">    Merges the data of two GeoDataFrames containing GEDI L2A and L2B data. If</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a><span class="sd">    dictionaries are provided, the function assumes key, value pairs of the dictionary</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a><span class="sd">    output of `gedixr.extract.extract_data`. The function will merge the data of</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a><span class="sd">    matching geometries and return a dictionary of GeoDataFrames.</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="sd">    l2a: GeoDataFrame or dict</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="sd">        GeoDataFrame or a dictionary of GeoDataFrames containing GEDI L2A data.</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="sd">    l2b: GeoDataFrame or dict</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="sd">        GeoDataFrame or a dictionary of GeoDataFrames containing GEDI L2B data.</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="sd">    how: str, optional</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="sd">        The type of merge to be performed. Default is &#39;inner&#39;.</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="sd">    on: str or list of str, optional</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="sd">        The column(s) to merge on. Default is [&#39;geometry&#39;, &#39;shot&#39;, &#39;acq_time&#39;].</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a><span class="sd">    -------</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="sd">    merged_out: GeoDataFrame or dict</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="sd">        A GeoDataFrame or a dictionary of GeoDataFrames containing the merged</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a><span class="sd">        GEDI L2A and L2B data.</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>    <span class="n">suffixes</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_l2a&#39;</span><span class="p">,</span> <span class="s1">&#39;_l2b&#39;</span><span class="p">)</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>    <span class="k">if</span> <span class="n">on</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>        <span class="n">on</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;geometry&#39;</span><span class="p">,</span> <span class="s1">&#39;shot&#39;</span><span class="p">,</span> <span class="s1">&#39;acq_time&#39;</span><span class="p">]</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>    <span class="k">if</span> <span class="nb">all</span><span class="p">([</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">gdf</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="k">for</span> <span class="n">gdf</span> <span class="ow">in</span> <span class="p">[</span><span class="n">l2a</span><span class="p">,</span> <span class="n">l2b</span><span class="p">]]):</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">l2a</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l2b</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;WARNING: The provided dictionaries contain data from a &quot;</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>                  <span class="sa">f</span><span class="s2">&quot;different number of geometries: &quot;</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>                  <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">l2a</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="si">}</span><span class="s2"> vs. </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">l2b</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="si">}</span><span class="s2">).&quot;</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>                  <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Only data of matching geometries will be merged and returned.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>        <span class="n">matched</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">l2a</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">l2b</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">matched</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;No matching geometries found between the provided &quot;</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>                               <span class="s2">&quot;dictionaries.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>        <span class="n">merged_out</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>        <span class="k">for</span> <span class="n">aoi</span> <span class="ow">in</span> <span class="n">matched</span><span class="p">:</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>            <span class="n">_run_checks</span><span class="p">(</span><span class="n">l2a</span><span class="p">[</span><span class="n">aoi</span><span class="p">],</span> <span class="n">l2b</span><span class="p">[</span><span class="n">aoi</span><span class="p">],</span> <span class="n">key</span><span class="o">=</span><span class="n">aoi</span><span class="p">)</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>            <span class="n">merged_gdf</span> <span class="o">=</span> <span class="n">l2b</span><span class="p">[</span><span class="n">aoi</span><span class="p">][</span><span class="s1">&#39;gdf&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">l2a</span><span class="p">[</span><span class="n">aoi</span><span class="p">][</span><span class="s1">&#39;gdf&#39;</span><span class="p">],</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>                                               <span class="n">how</span><span class="o">=</span><span class="n">how</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="n">on</span><span class="p">,</span> <span class="n">suffixes</span><span class="o">=</span><span class="n">suffixes</span><span class="p">)</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>            <span class="n">merged_out</span><span class="p">[</span><span class="n">aoi</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>            <span class="n">merged_out</span><span class="p">[</span><span class="n">aoi</span><span class="p">][</span><span class="s1">&#39;gdf&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">merged_gdf</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>            <span class="n">merged_out</span><span class="p">[</span><span class="n">aoi</span><span class="p">][</span><span class="s1">&#39;geo&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">l2a</span><span class="p">[</span><span class="n">aoi</span><span class="p">][</span><span class="s1">&#39;geo&#39;</span><span class="p">]</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>    <span class="k">elif</span> <span class="nb">all</span><span class="p">([</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">gdf</span><span class="p">,</span> <span class="n">GeoDataFrame</span><span class="p">)</span> <span class="k">for</span> <span class="n">gdf</span> <span class="ow">in</span> <span class="p">[</span><span class="n">l2a</span><span class="p">,</span> <span class="n">l2b</span><span class="p">]]):</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>        <span class="n">_compare_gdfs</span><span class="p">(</span><span class="n">l2a</span><span class="p">,</span> <span class="n">l2b</span><span class="p">)</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>        <span class="n">merged_out</span> <span class="o">=</span> <span class="n">l2b</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">l2a</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="n">how</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="n">on</span><span class="p">,</span> <span class="n">suffixes</span><span class="o">=</span><span class="n">suffixes</span><span class="p">)</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;The provided input is not supported.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>    <span class="k">return</span> <span class="n">merged_out</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div><h3 id="gdf_to_xr">gdf_to_xr<a class="headerlink" href="#gdf_to_xr" title="Permanent link">&para;</a></h3>


<div class="doc doc-object doc-function">



<a id="gedixr.xr.gdf_to_xr"></a>
    <div class="doc doc-contents first">

        <p>Rasterizes a GeoDataFrame containing GEDI L2A/L2B data to an xarray Dataset.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>gdf</code>
            </td>
            <td>
                  <code><span title="geopandas.GeoDataFrame">GeoDataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>GeoDataFrame containing GEDI L2A/L2B data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>measurements</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="list">list</span>[<span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of measurements names (i.e. GEDI variables) to be included.
Default is None, which will include all measurements.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>resolution</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="tuple">tuple</span>[<span title="float">float</span>, <span title="float">float</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A tuple of the pixel spacing of the returned data (Y, X). This includes
the direction (as indicated by a positive or negative number). Default
is (-0.0003, 0.0003), which corresponds to a spacing of 30 m.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>cube</code></td>            <td>
                  <code><span title="xarray.Dataset">Dataset</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An xarray Dataset containing the rasterized GEDI data.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>gedixr/xr.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-144" name="__codelineno-0-144"></a><span class="k">def</span><span class="w"> </span><span class="nf">gdf_to_xr</span><span class="p">(</span><span class="n">gdf</span><span class="p">:</span> <span class="n">GeoDataFrame</span><span class="p">,</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>              <span class="n">measurements</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>              <span class="n">resolution</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>              <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dataset</span><span class="p">:</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a><span class="sd">    Rasterizes a GeoDataFrame containing GEDI L2A/L2B data to an xarray Dataset.</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a><span class="sd">    Parameters</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="sd">    ----------</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="sd">    gdf: GeoDataFrame</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="sd">        GeoDataFrame containing GEDI L2A/L2B data.</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a><span class="sd">    measurements: list of str, optional</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="sd">        List of measurements names (i.e. GEDI variables) to be included.</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="sd">        Default is None, which will include all measurements.</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a><span class="sd">    resolution: tuple of float, optional</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a><span class="sd">        A tuple of the pixel spacing of the returned data (Y, X). This includes</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="sd">        the direction (as indicated by a positive or negative number). Default</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="sd">        is (-0.0003, 0.0003), which corresponds to a spacing of 30 m.</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="sd">    Returns</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a><span class="sd">    -------</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="sd">    cube: Dataset</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="sd">        An xarray Dataset containing the rasterized GEDI data.</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a>    <span class="k">if</span> <span class="n">resolution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a>        <span class="n">resolution</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.0003</span><span class="p">,</span> <span class="mf">0.0003</span><span class="p">)</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>    <span class="n">xr_ds</span> <span class="o">=</span> <span class="n">make_geocube</span><span class="p">(</span><span class="n">vector_data</span><span class="o">=</span><span class="n">gdf</span><span class="p">,</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>                         <span class="n">measurements</span><span class="o">=</span><span class="n">measurements</span><span class="p">,</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>                         <span class="n">output_crs</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;epsg:</span><span class="si">{</span><span class="n">gdf</span><span class="o">.</span><span class="n">crs</span><span class="o">.</span><span class="n">to_epsg</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a>                         <span class="n">resolution</span><span class="o">=</span><span class="n">resolution</span><span class="p">)</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a>    <span class="k">return</span> <span class="n">xr_ds</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "..", "features": ["navigation.tabs", "navigation.sections", "navigation.top", "search.suggest", "search.highlight", "content.code.copy"], "search": "../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>